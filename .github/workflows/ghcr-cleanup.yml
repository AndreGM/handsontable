name: GHCR cleanup

on:
  schedule:
    - cron: '0 0 * * *'  # every day at midnight
  push:
    branches:
      - feature/issue-9123
      - feature/issue-9123-test

jobs:
  clean-ghcr:
    name: Delete old unused images
    runs-on: ubuntu-latest
    steps:
      - name: Delete documentation images older than a month
        uses: snok/container-retention-policy@1c634b2fbfbadeda00368373761cccf6496f628a
        with:
          image-names: handsontable/handsontable-documentation
          cut-off: One month ago UTC
          account-type: org
          org-name: handsontable
          skip-tags: latest, production
          token: ${{ secrets.WARPECH_PAT_DELETE_PACKAGES }}
